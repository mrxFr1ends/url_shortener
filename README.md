# Shortener Service

Shortener - это HTTP сервис для создания сокращенных URL-адресов и перехода по ним. 

## Содержание

- [Установка](#установка)
- [Конфигурация](#конфигурация)
- [Использование](#использование)
- [API Endpoints](#api-endpoints)
- [База данных](#база-данных)

## Установка

1. Клонируйте репозиторий: `git clone https://github.com/mrxFr1ends/url_shortener.git`
2. Перейдите в католог проекта: `cd url_shortener`
3. Установите зависимости: `npm install`
4. Создайте `.env` файл в коневом каталоге проекта, заполнив [его](#конфигурация)
5. Запустите сервер: `npm start`

## Конфигурация

Перед запуском проекта создайте `.env` файл в корневом каталоге проекта. Структура и переменные окружения должны быть следующие:

```env
PORT=<Порт на котором будет запущен сервер. По умолчанию 3000>
DB_HOST=<Хост базы данных>
DB_USER=<Имя пользователя от базы данных>
DB_DATABASE=<Название базы данных>
DB_PASSWORD=<Пароль от пользователя базы данных>
```

Замените заполнители вашими учетными данными базы данных.

## Использование

Как только сервер запущен, вы можете получить доступ к API, используя следующий базовый URL: `http://localhost:3000/`

Для сборки проекта используйте команду: `npm run build`

Для тестирования: `npm run test` или `npm run test:coverage`

## API Endpoints

### 1. Перенаправление на исходный URL

- Endpoint: `GET /:shortUrl`
- Описание: Перенаправляет пользователя на исходный URL-адрес, связанный с предоставленным коротким URL-адресом.
- Ответы:
  - Код 302: Перенаправляет пользователя на исходный URL.
  - Код 404: shortUrl не существует в базе данных.
  - Код 400: неправильный формат shortUrl.

### 2. Создание короткого URL

- Endpoint: `POST /`
- Описание: Создает новый короткий URL-адрес, используя предоставленный исходный URL-адрес и, при необходимости, пользовательский URL-адрес.
- Структура запроса:
  - `originalUrl` (строка, обязательно): Исходный URL-адрес, который необходимо сократить. Должен быть действительный URL-адрес.
  - `customUrl` (строка, опционально): Пользовательский URL-адрес, который будет использоваться в качестве короткого URL-адреса. 
  - Пример запроса
    ```json
    {
      "originalUrl": "https://google.com",
      "customUrl": "someCustomUrl"
    }
    ```
- Ответы:
  - Код 201: Короткий URL-адрес успешно создан. Возвращает объект, содержащий `originalUrl` и `shortUrl`.
  - Код 400: Неверный формат запроса или `customUrl` уже занят.
  - Пример ответа
    ```json
    {
      "originalUrl": "https://google.com",
      "shortUrl": "http://localhost:3000/someCustomUrl"
    }
    ```

# База данных

## Описание
Таблица `urls` представляет собой схему данных для хранения информации о URL-адресах. Каждая запись таблицы содержит уникальный идентификатор, оригинальный URL-адрес и соответствующий ему сокращенный URL-адрес.

## Структура таблицы urls
1. **id** - идентификатор записи.
    - Тип: `INTEGER`
    - Параметры:
      - `allowNull: false` - Не может принимать значение NULL.
      - `autoIncrement: true` - Автоматически инкрементируется для генерации уникального идентификатора.
      - `primaryKey: true` - Является первичным ключом (в связке с `shortUrl`).

2. **originalUrl** - оригинальный URL-адрес. Может быть не уникальным т.к. у одного `originalUrl` может быть несколько пользовательских URL-адресов. 
    - Тип: `STRING` (`VARCHAR(255)`)
    - Параметры:
      - `unique: false` - Может быть не уникальным. У одного `originalUrl` может быть несколько пользовательских URL-адресов. 
      - `allowNull: false` - Не может принимать значение NULL.

3. **shortUrl** - сокращенный URL-адрес. Является пользовательской или сгенерированной сервером строкой. Обязательно должен быть уникальным.
    - Тип: `STRING` (`VARCHAR(255)`)
    - Параметры:
      - `allowNull: false` - Не может принимать значение NULL.
      - `unique: true` - Уникальный
      - `primaryKey: true` - Является первичным ключом (в связке с `id`)